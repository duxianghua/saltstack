# Generated by saltstack v1 on 2016-03-28 for app serves
*filter
:INPUT DROP [0:0]
:FORWARD DROP [0:0]
:OUTPUT ACCEPT [0:0]
-A INPUT -i lo -j ACCEPT
-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
-A INPUT -s 10.1.10.12/32 -p udp -m state --state NEW -m udp --dport 161 -j ACCEPT
{% if pillar['custom']['group_name'] == 'web' %}
-A INPUT -s 10.1.0.0/16 -p tcp -m state --state NEW -m tcp --dport 80 -j ACCEPT
-A INPUT -s 10.1.0.0/16 -p tcp -m state --state NEW -m tcp --dport 443 -j ACCEPT
{% endif %}
{% if pillar['custom']['group_name'] == 'haproxy' %}
-A INPUT -s 0.0.0.0 -p tcp -m state --state NEW -m tcp --dport 80 -j ACCEPT
#-A INPUT -s 0.0.0.0 -p tcp -m state --state NEW -m tcp --dport 443 -j ACCEPT
{% endif %}
{% if pillar['custom']['group_name'] == 'redis' %}
-A INPUT -s 10.1.0.0/16 -p tcp -m state --state NEW -m tcp --dport 6379 -j ACCEPT
-A INPUT -s 10.1.0.0/16 -p tcp -m state --state NEW -m tcp --dport 26379 -j ACCEPT
{% endif %}
{% if pillar['custom']['group_name'] == 'nginx' %}
-A INPUT -s 0.0.0.0 -p tcp -m state --state NEW -m tcp --dport 80 -j ACCEPT
#-A INPUT -s 0.0.0.0 -p tcp -m state --state NEW -m tcp --dport 443 -j ACCEPT
{% endif %}
{% if pillar['custom']['group_name'] == 'memcache' %}
-A INPUT -s 10.1.0.0/16 -p tcp -m state --state NEW -m tcp --dport 11211 -j ACCEPT
{% endif %}
-A INPUT -s 10.1.0.0/16 -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT
-A INPUT -p icmp -m icmp --icmp-type 8 -j ACCEPT
-A INPUT -m limit --limit 5/sec -j LOG --log-prefix "iptables: " --log-level 7
COMMIT
# Completed on Mon Nov 30 17:06:49 2015